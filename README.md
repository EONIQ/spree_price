# Spree Price

heavily inspired by [spree-contrib/spree_price_book](https://github.com/spree-contrib/spree_price_books).
1. Support multiple store price
2. Support multiple type of prices (e.g. sales price, marked price, manufacturer's suggested retail price
3. Support price book. Price book can be prioritized at store.
4. Auto adjust prices according to exchange rate. 
5. Price is found by the following order.
    - Manual set price
    - Price book with higher priority in the same store
    - Parent price book with higher priority in the same store * currency exchange
    - Price book with higher priority of other price type 
    - Parent price book with higher priority of other price type in the same store * currency exchange
  
6. The price will not be populated. It will be calculated on the fly if it is not set manually. 

### Installation
Add spree_price_books to your Gemfile:

```shell
gem 'spree_price_books', github: 'EONIQ/spree_price'
```

Bundle your dependencies and run the installation generator:
```shell
bundle
bundle exec rails g spree_price:install
```

### Configuration
Once installed you can seed default currency exchange rates via open exchange rate

Get your app id from https://openexchangerates.org/signup

Add open_exchange_rate.rb to config/initializers
```
Rails.application.config.openExchangeRate = {
  appId: 'YOUR APP ID HERE',
}
bundle exec rake price_books:currency_rates
```

### Testing
First bundle your dependencies, then run rake. rake will default to building the dummy app if it does not exist, then it will run specs. The dummy app can be regenerated by using rake test_app.

On the first run you may need to create the Postgresql role (ex. createuser -d postgres)

```
bundle
bundle exec rake
```

When testing your applications integration with this extension you may use it's factories. Simply add this require statement to your spec_helper:

```
require 'spree_price_books/factories'
```

### Credit
(spree-contrib/spree_price_book)[https://github.com/spree-contrib/spree_price_books].

Copyright (c) 2018 EONIQ (HK) LIMITED, released under the New BSD License
