# Spree Price

heavily inspired by (spree-contrib/spree_price_book)[https://github.com/spree-contrib/spree_price_books].
1. Support multiple store price
2. Support multiple type of prices (e.g. sales price, marked price, manufacturer's suggested retail price
3. Support price book. Price book can be prioritized at store.
4. Auto adjust prices according to exchange rate. 
5. If price is not set, find the most relevant price. It will find the price book in the same store with lower priority price book first. If the price is not available in every price book of the store, it will find the parent price book * the currency exchange ordered by the price book priority. If the price is also not available in every parent price book, it will find the price book with different price type (Sales price / marked price) ordered by the priority of the price type. If it still cannot find the price, it will return nil. 
6. When the price is set manually, the price will not be populated. 

### Installation
Add spree_price_books to your Gemfile:

```shell
gem 'spree_price_books', github: 'EONIQ/spree_price'
```

Bundle your dependencies and run the installation generator:
```shell
bundle
bundle exec rails g spree_price:install
```

### Configuration
Once installed you can seed default currency exchange rates via open exchange rate

Get your app id from https://openexchangerates.org/signup

Add open_exchange_rate.rb to config/initializers
```
Rails.application.config.openExchangeRate = {
  appId: 'YOUR APP ID HERE',
}
bundle exec rake price_books:currency_rates
```

### Testing
First bundle your dependencies, then run rake. rake will default to building the dummy app if it does not exist, then it will run specs. The dummy app can be regenerated by using rake test_app.

On the first run you may need to create the Postgresql role (ex. createuser -d postgres)

```
bundle
bundle exec rake
```

When testing your applications integration with this extension you may use it's factories. Simply add this require statement to your spec_helper:

```
require 'spree_price_books/factories'
```

### Credit
(spree-contrib/spree_price_book)[https://github.com/spree-contrib/spree_price_books].

Copyright (c) 2018 EONIQ (HK) LIMITED, released under the New BSD License
